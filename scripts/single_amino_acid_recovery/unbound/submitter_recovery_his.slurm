#!/bin/bash
#SBATCH --nodes 1
#SBATCH --ntasks-per-node 1
#SBATCH --cpus-per-task 1
#SBATCH --mem 8192
#SBATCH --time 24:00:00
#SBATCH --partition serial
#SBATCH --output=./his.%A_%a.out
#SBATCH --error=./his.%A_%a.err

pdb_id=("3KJ0_A_B" "3BDY_HL_V" "4MHJ_L_H" "4CVW_A_C" "2G77_A_B" "4FQJ_HL_A" "3JZA_A_B" "4XNY_HL_G" "2W80_A_D" "1HIA_AB_I" "5AYS_A_C" "1H59_A_B" "4A94_A_D" "4HCN_A_B" "4W6Y_A_B" "1A2K_C_AB" "3EOA_LH_I" "1I9R_HL_ABC" "2WWX_A_B" "5T5F_HL_A" "1GL1_A_I" "1FC2_C_D" "3N85_HL_A" "3ZYI_A_B" "1F5R_A_I" "4AOQ_A_D" "3ZNZ_A_B" "3ZYJ_A_B" "3HO5_B_H" "4PER_A_B" "5JZ7_CD_A" "3OHM_A_B" "3NH7_KO_D" "1FY8_E_I" "4PEQ_A_B" "1YRT_A_B" "1B2S_A_D" "2QC1_A_B" "4ZGY_A_B" "4DZV_A_B" "1MAH_A_F" "2XHE_A_B" "1ZJD_A_B" "4ONS_A_B" "4BZ2_HL_A" "1EGJ_HL_A" "1KKL_ABC_H" "1CBW_ABC_D" "4K9E_HL_C" "2XBB_A_C" "5T5F_HL_A" "4EIZ_A_D" "1PPE_E_I" "4G35_A_B" "5C3F_A_B" "2J8X_A_B" "4XKL_A_B" "3TAC_A_B" "3E1Z_A_B" "5ABV_A_B" "4LQW_A_D" "3RGF_A_B" "1TH1_A_C" "3FJU_A_B" "4NE9_A_P" "1RV6_VW_X" "1EER_A_BC" "4ETP_A_B" "2WG3_A_C" "3AJB_A_B" "3P9W_A_B" "5GGT_HL_A" "4YPI_C_G" "2G2U_A_B" "2ADF_HL_A" "3DDC_A_B" "4KUC_FE_I" "4WNN_A_B" "5CMN_A_E" "2FJH_BA_W" "3C4M_A_C" "4F9L_A_B" "1LP1_A_B" "5LXM_A_D" "1P27_A_B" "4LQW_A_D" "1JWH_CD_A" "4I6L_A_B" "4HX3_BD_A" "4ZRP_A_C" "2VOI_A_B" "4PJ2_A_D" "4OVN_A_F" "4QCI_HL_C" "4KV5_C_D" "3SGB_E_I" "2MBB_A_B" "2B2X_HL_A" "2ES4_A_D" "5W1K_DC_E" "3C66_A_C" "5B3J_EF_C" "1OPH_A_B" "1AN1_E_I" "1TA3_A_B" "1KTZ_A_B" "4MSM_A_B" "2DSP_B_I" "5HBT_DC_B" "4HC1_MN_B" "4HJ0_PQ_A" "5EO9_A_B" "1V18_A_B" "3N0P_A_B" "2B2X_HL_A" "1ZLI_A_B" "1TM1_E_I" "5D1L_A_B" "2Y8T_A_B" "1R0R_E_I" "3FJU_A_B" "2AYO_A_B" "4C2A_A_B" "2UUY_A_B" "1O9A_A_B" "2TGP_Z_I" "1WR6_A_E" "3OUX_A_B" "1UDI_E_I" "4FQ0_B_C" "3TSR_A_E" "2Y5B_A_B" "4KFZ_A_C" "3TAC_A_B" "6CYF_UT_Q" "1IJK_A_BC" "4V0M_F_E" "4RWT_A_D" "5XWD_HD_A" "2OOB_A_B" "3OJM_A_B" "5G1X_A_B" "5F4E_A_B" "1UDI_E_I" "3SUA_A_D" "4OII_HL_A" "5D1M_A_B" "2R56_HL_A" "3EJH_A_E" "2MCN_A_B" "2HTH_A_B" "3KJ1_A_B" "1V18_A_B" "5AYR_A_B" "4AOQ_A_D" "1YVB_A_I" "2WG3_A_C" "3V96_A_B" "3N0P_A_B" "3PNW_TS_U" "5CYK_A_B" "4KT1_A_E" "4UEM_A_B" "2ZCH_HL_P" "2NQD_A_B" "4RWS_A_C" "5AYS_A_C" "2N73_A_B" "3QBR_A_B" "4NIQ_A_C" "4LVN_CB_A" "3OKY_A_B" "1UUG_A_B" "2LQH_A_B" "2W8B_A_H" "5BOZ_A_G" "4HCN_A_B" "2N01_A_B" "4U30_A_X" "4F37_HL_A" "3TGK_E_I" "1F34_A_B" "4A94_A_D" "5MES_HL_A" "3OUX_A_B" "5ABV_A_B" "3GNI_A_B" "3BX7_A_C" "2MLZ_B_A" "2AEP_HL_A" "1ZR0_A_B" "5XXY_HL_A" "4AYD_A_D" "4DS8_A_B" "3IXE_A_B" "4KI5_EF_M" "2FTM_A_B" "3WO3_A_B" "2NY1_DC_A" "1L0Y_A_B")
chains1=("A" "H,L" "H" "C" "B" "A" "B" "G" "A" "A,B" "C" "B" "D" "B" "A" "A,B" "L,H" "A,B,C" "B" "H,L" "A" "D" "A" "A" "A" "A" "A" "A" "H" "B" "A" "A" "D" "E" "A" "B" "A" "A" "B" "A" "A" "B" "A" "A" "A" "A" "A,B,C" "A,B,C" "C" "C" "A" "A" "E" "A" "B" "A" "A" "A" "B" "A" "A" "A" "A" "B" "P" "X" "B,C" "A" "A" "A" "A" "A" "C" "B" "A" "A" "I" "B" "E" "W" "A" "A" "B" "A" "A" "D" "C,D" "A" "A" "C" "B" "D" "F" "H,L" "C" "E" "B" "A" "D" "E" "A" "C" "B" "E" "A" "A" "B" "B" "B" "M,N" "A" "A" "B" "A" "A" "A" "E" "B" "B" "E" "B" "A" "A" "A" "B" "Z" "E" "A" "E" "C" "A" "B" "A" "A" "U,T" "B,C" "E" "D" "A" "B" "A" "A" "B" "E" "D" "H,L" "A" "H,L" "A" "B" "B" "A" "A" "B" "A" "A" "A" "B" "B" "U" "A" "A" "A" "P" "B" "A" "A" "A" "A" "C" "A" "B" "A" "A" "H" "A" "A" "A" "A" "A" "E" "B" "A" "A" "A" "B" "B" "A" "B" "A" "A" "H,L" "D" "B" "A" "M" "A" "B" "D,C" "B")
chains2=("B" "V" "L" "A" "A" "H,L" "A" "H,L" "D" "I" "A" "A" "A" "A" "B" "C" "I" "H,L" "A" "A" "I" "C" "H,L" "B" "I" "D" "B" "B" "B" "A" "C,D" "B" "K,O" "I" "B" "A" "D" "B" "A" "B" "F" "A" "B" "B" "H,L" "H,L" "H" "D" "H,L" "A" "H,L" "D" "I" "B" "A" "B" "B" "B" "A" "B" "D" "B" "C" "A" "A" "V,W" "A" "B" "C" "B" "B" "H,L" "G" "A" "H,L" "B" "F,E" "A" "A" "B,A" "C" "B" "A" "D" "B" "A" "A" "B" "B,D" "A" "A" "A" "A" "C" "D" "I" "A" "H,L" "A" "D,C" "C" "E,F" "A" "I" "B" "B" "A" "I" "D,C" "B" "P,Q" "B" "A" "B" "H,L" "B" "I" "A" "A" "I" "A" "B" "B" "B" "A" "I" "A" "B" "I" "B" "E" "A" "C" "B" "Q" "A" "F" "A" "H,D" "A" "B" "B" "A" "I" "A" "A" "B" "A" "E" "A" "A" "B" "B" "A" "D" "I" "C" "A" "A" "T,S" "B" "E" "B" "H,L" "A" "C" "C" "B" "B" "A" "C,B" "A" "B" "B" "A" "G" "B" "B" "X" "H,L" "I" "A" "D" "H,L" "B" "A" "A" "C" "A" "H,L" "B" "A" "A" "A" "B" "E,F" "B" "A" "A" "A")
mut_res=("224A" "91L" "172H" "24C" "102B" "85A" "376B" "105G" "371A" "172B" "87C" "71B" "40D" "68B" "88A" "124B" "52H" "249A" "376B" "31L" "57A" "310D" "451A" "296A" "57A" "46A" "339A" "276A" "133H" "111B" "8A" "218A" "43D" "40E" "119A" "107B" "102A" "68A" "202B" "19A" "287A" "258B" "57A" "152A" "390A" "367A" "140A" "40B" "378C" "68C" "119A" "114A" "57E" "224A" "89B" "94A" "68A" "273A" "159B" "67A" "121A" "88A" "224A" "54B" "113P" "223X" "153C" "377A" "181A" "334A" "90A" "69A" "327C" "41B" "1023A" "27A" "106I" "112B" "250E" "27W" "114A" "122A" "18B" "187A" "140A" "87D" "193D" "217A" "83A" "155C" "89B" "93D" "1900F" "92L" "68C" "57E" "268B" "288A" "67D" "128E" "482A" "60C" "57B" "40E" "228A" "34A" "68B" "70B" "3B" "50N" "115A" "114A" "1490B" "27A" "261A" "196A" "64E" "168B" "1301B" "64E" "38B" "425A" "1326A" "43A" "27B" "57Z" "68E" "260A" "91E" "138C" "120A" "76B" "128A" "120A" "106U" "222C" "111E" "272D" "409A" "68B" "108A" "280A" "65B" "191E" "1814D" "30L" "7A" "31H" "535A" "68B" "85B" "252A" "265A" "87B" "63A" "159A" "135A" "221B" "188B" "581U" "409A" "157A" "305A" "101P" "163B" "281A" "91A" "45A" "70A" "196C" "394A" "212B" "187A" "17A" "158H" "65A" "211A" "36A" "57A" "6A" "57E" "53B" "196A" "320A" "219A" "594B" "-12B" "47A" "447B" "197A" "57A" "94L" "184D" "245B" "99A" "2309M" "57A" "27B" "3059D" "85B")

for i in {0..200}
do
    srun /PATH_TO_ROSETTA/source/bin/rosetta_scripts.default.linuxiccrelease -parser:protocol recovery.xml -ignore_unrecognized_res -out:file:score_only recover_his.sc -s ${pdb_id[$i]}.pdb -parser:script_vars c1=${chains1[$i]} c2=${chains2[$i]} r=${mut_res[$i]} -out:no_nstruct_label -mute core.scoring.sc.ShapeIdentityCalculator -in:file:native ${pdb_id[$i]}.pdb
done
    
